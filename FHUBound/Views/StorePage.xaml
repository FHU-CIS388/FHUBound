<?xml version="1.0" encoding="UTF-8" ?>
<ContentPage
    x:Class="FHUBound.Views.StorePage"
    xmlns="http://xamarin.com/schemas/2014/forms"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:d="http://xamarin.com/schemas/2014/forms/design"
    xmlns:flex="clr-namespace:Flex.Controls;assembly=Flex"
    xmlns:local="clr-namespace:FHUBound"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:models="clr-namespace:FHUBound.Models"
    xmlns:pancake="clr-namespace:Xamarin.Forms.PancakeView;assembly=Xamarin.Forms.PancakeView"
    Title="Store"
    BackgroundColor="{StaticResource White}"
    Shell.NavBarIsVisible="False"
    mc:Ignorable="d">
    <ContentPage.Resources>
        <ResourceDictionary>
            <local:StringNullOrEmptyBoolConverter x:Key="StringNullOrEmptyBoolConverter" />
        </ResourceDictionary>
    </ContentPage.Resources>
    <ContentPage.Content>
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="200" />
                <RowDefinition Height="auto" />
            </Grid.RowDefinitions>
            <Grid Grid.Row="0" Padding="16,60,16,0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*" />
                    <RowDefinition Height="0" />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="auto" />
                </Grid.ColumnDefinitions>

                <!--  Page Header  -->
                <Label
                    Grid.Row="0"
                    Grid.Column="0"
                    Padding="0"
                    LineBreakMode="WordWrap"
                    Style="{StaticResource LargeText}"
                    Text="FHUBound Shop" />

                <flex:FlexButton
                    Grid.Row="0"
                    Grid.Column="1"
                    Margin="0"
                    Padding="8"
                    BackgroundColor="{StaticResource GradientBlueDark}"
                    BorderColor="{StaticResource LightWhite}"
                    BorderThickness="1"
                    Clicked="OpenCalendar"
                    CornerRadius="16"
                    FontFamily="{StaticResource BoldFont}"
                    FontSize="25"
                    ForegroundColor="{StaticResource LightWhite}"
                    HeightRequest="48"
                    HighlightBackgroundColor="{StaticResource LightWhite}"
                    HighlightBorderColor="{StaticResource GradientBlueDark}"
                    HighlightForegroundColor="{StaticResource GradientBlueDark}"
                    Text="{Binding User.CurrentPoints, StringFormat='{0:0} 🦁'}"
                    VerticalOptions="Start" />
            </Grid>

            <!--  CollectionView of Cards  -->

            <CollectionView
                x:Name="StoreCollectionView"
                Grid.Row="1"
                Margin="{OnPlatform Android='0',
                                    iOS='0,0,0,80'}"
                ItemsSource="{Binding StoreItemCards}">
                <d:CollectionView.ItemsSource>
                    <x:Array Type="{x:Type models:Card}">
                        <models:Card
                            ButtonText="Watch More"
                            HeaderSubtitle="DEVO"
                            HeaderTitle="Devos with David" />
                        <models:Card
                            ButtonText="Explore Majors"
                            HeaderSubtitle="MAJORS"
                            HeaderTitle="Find Your Fit"
                            ImageUrl="istockpuzzle.jpg" />
                    </x:Array>
                </d:CollectionView.ItemsSource>

                <!--  Spacer for page header  -->
                <CollectionView.Header>
                    <StackLayout />
                </CollectionView.Header>

                <CollectionView.ItemTemplate>
                    <DataTemplate>

                        <Grid
                            Padding="16,0,16,16"
                            HorizontalOptions="FillAndExpand"
                            VerticalOptions="FillAndExpand">
                            <pancake:PancakeView
                                Padding="0"
                                BackgroundColor="{StaticResource LightWhite}"
                                BackgroundGradientAngle="15"
                                BackgroundGradientEndColor="{StaticResource GradientBlueLight}"
                                BackgroundGradientStartColor="{StaticResource GradientBlueDark}"
                                CornerRadius="16"
                                HasShadow="True"
                                HorizontalOptions="FillAndExpand"
                                IsClippedToBounds="False">

                                <Grid Padding="0">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="*" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>

                                    <!--  Card Header  -->
                                    <StackLayout Grid.Row="0" Padding="16,16">
                                        <Label
                                            Margin="0"
                                            HorizontalOptions="FillAndExpand"
                                            HorizontalTextAlignment="Center"
                                            Style="{StaticResource HeaderTitle}"
                                            Text="{Binding HeaderTitle}"
                                            TextColor="{StaticResource LightWhite}" />
                                    </StackLayout>

                                    <!--  Card Body  -->
                                    <Grid Grid.Row="1">
                                        <StackLayout Margin="0" Padding="0">
                                            <Image
                                                Margin="0"
                                                Aspect="AspectFill"
                                                HorizontalOptions="FillAndExpand"
                                                Source="{Binding ImageUrl}"
                                                VerticalOptions="FillAndExpand" />

                                            <StackLayout Padding="16,8" Spacing="4">
                                                <Label
                                                    HorizontalTextAlignment="Center"
                                                    Style="{StaticResource LargeText}"
                                                    Text="{Binding Value, StringFormat='🦁 {0:0}'}"
                                                    TextColor="{StaticResource LightWhite}" />


                                                <Label
                                                    HorizontalTextAlignment="Center"
                                                    Style="{StaticResource MediumText}"
                                                    Text="BoundBucks"
                                                    TextColor="{StaticResource LightWhite}" />
                                            </StackLayout>
                                        </StackLayout>
                                    </Grid>

                                    <StackLayout
                                        Grid.Row="2"
                                        Margin="-20,0,-40,-20"
                                        Padding="16,0,16,20">

                                        <flex:FlexButton
                                            Margin="0,10,0,10"
                                            Padding="0,0,20,0"
                                            BackgroundColor="Transparent"
                                            ClickedCommand="{Binding Path=BindingContext.AlertPopUp, Source={x:Reference StoreCollectionView}}"
                                            ClickedCommandParameter="{Binding .}"
                                            FontFamily="{StaticResource BlackFont}"
                                            FontSize="28"
                                            ForegroundColor="{StaticResource LightWhite}"
                                            HeightRequest="50"
                                            HighlightBackgroundColor="Transparent"
                                            HighlightForegroundColor="{StaticResource GradientBlueLight}"
                                            IsVisible="{Binding PointsButtonBool}"
                                            Text="REDEEM NOW"
                                            WidthRequest="300" />
                                    </StackLayout>
                                </Grid>
                            </pancake:PancakeView>
                        </Grid>

                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </Grid>
    </ContentPage.Content>

</ContentPage>
